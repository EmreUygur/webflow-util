{
  "version": 3,
  "sources": ["../../src/webflow-url/relativeLinkFixup.ts"],
  "sourcesContent": ["\r\n/*\r\n * query\r\n * \r\n * Sygnal Technology Group\r\n * http://sygnal.com\r\n * \r\n * Url Utilities\r\n */\r\n\r\nimport { Sa5Core } from '../webflow-core'\r\n\r\n/*\r\n * Link-processing functions.\r\n * Fixues up //self/ relative links for CMS.\r\n */\r\n\r\nexport class WfuRelativeLinkFixup {\r\n\r\n//    config; // Optional config\r\n    private _element: HTMLElement;\r\n\r\n    // TODO: Support alternatives \r\n\r\n    constructor(element: HTMLElement) {\r\n\r\n        this._element = element;\r\n//        this.config = config;\r\n\r\n    }\r\n\r\n    // Process elements with the custom attr wfu-query-param\r\n    init() {\r\n\r\n        // Case insensitive jQuery attribute selector\r\n        // https://stackoverflow.com/a/38923109\r\n\r\n        // Fixup broken Webflow relative links\r\n        // where it prepends http://.\r\n        // Valid links should include \r\n        // ./sdlfj\r\n        // lksdfj\r\n        // ?lkdsfj\r\n\r\n        // Get all 'a' elements with 'href' attribute containing '//self/'\r\n        let elems = Array.from(\r\n            this._element.querySelectorAll(\r\n                \"a[href^='http://.' i], a[href^='https://.' i], a[href^='http://?' i], a[href^='https://?' i]\"));\r\n\r\n        elems.forEach((elem) => {\r\n            // Get the href attribute\r\n            let href = elem.getAttribute('href');\r\n\r\n            if (href) {\r\n\r\n                // Create a new href\r\n                if(href.startsWith(\"http://.\"))\r\n                    href = href.substring(8);\r\n                if(href.startsWith(\"https://.\"))\r\n                    href = href.substring(9);\r\n                if(href.startsWith(\"http://?\"))\r\n                    href = href.substring(7);\r\n                if(href.startsWith(\"https://?\"))\r\n                    href = href.substring(8);\r\n\r\n                // Set the href attribute to the pathname of the URL\r\n                elem.setAttribute('href', href);\r\n            }\r\n        });\r\n\r\n\r\n        // Get all 'a' elements with 'href' attribute containing '//self/'\r\n        let elements = Array.from(\r\n            this._element.querySelectorAll(\"a[href*='//self/' i], a[href$='//self' i]\"));\r\n\r\n        elements.forEach((element) => {\r\n            // Get the href attribute\r\n            let originalHref = element.getAttribute('href');\r\n\r\n            if (originalHref) {\r\n                // Create a new URL object\r\n                const originalUrl = new URL(originalHref);\r\n\r\n                // Create relative path\r\n                let relativeHref: string = originalUrl.pathname + originalUrl.search + originalUrl.hash;\r\n\r\n                // Set the href attribute to the pathname of the URL\r\n                element.setAttribute('href', relativeHref);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n}"],
  "mappings": ";;AAiBO,MAAM,uBAAN,MAA2B;AAAA,IAO9B,YAAY,SAAsB;AAE9B,WAAK,WAAW;AAAA,IAGpB;AAAA,IAGA,OAAO;AAaH,UAAI,QAAQ,MAAM;AAAA,QACd,KAAK,SAAS;AAAA,UACV;AAAA,QAA8F;AAAA,MAAC;AAEvG,YAAM,QAAQ,CAAC,SAAS;AAEpB,YAAI,OAAO,KAAK,aAAa,MAAM;AAEnC,YAAI,MAAM;AAGN,cAAG,KAAK,WAAW,UAAU;AACzB,mBAAO,KAAK,UAAU,CAAC;AAC3B,cAAG,KAAK,WAAW,WAAW;AAC1B,mBAAO,KAAK,UAAU,CAAC;AAC3B,cAAG,KAAK,WAAW,UAAU;AACzB,mBAAO,KAAK,UAAU,CAAC;AAC3B,cAAG,KAAK,WAAW,WAAW;AAC1B,mBAAO,KAAK,UAAU,CAAC;AAG3B,eAAK,aAAa,QAAQ,IAAI;AAAA,QAClC;AAAA,MACJ,CAAC;AAID,UAAI,WAAW,MAAM;AAAA,QACjB,KAAK,SAAS,iBAAiB,2CAA2C;AAAA,MAAC;AAE/E,eAAS,QAAQ,CAAC,YAAY;AAE1B,YAAI,eAAe,QAAQ,aAAa,MAAM;AAE9C,YAAI,cAAc;AAEd,gBAAM,cAAc,IAAI,IAAI,YAAY;AAGxC,cAAI,eAAuB,YAAY,WAAW,YAAY,SAAS,YAAY;AAGnF,kBAAQ,aAAa,QAAQ,YAAY;AAAA,QAC7C;AAAA,MACJ,CAAC;AAAA,IAEL;AAAA,EAEJ;",
  "names": []
}
