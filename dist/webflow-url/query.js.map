{
  "version": 3,
  "sources": ["../../src/webflow-url/query.ts"],
  "sourcesContent": ["\r\n/*\r\n * query\r\n * Adds querystring data to specific tagged elements.\r\n * \r\n * Sygnal Technology Group\r\n * http://sygnal.com\r\n * \r\n * Url Utilities\r\n */\r\n\r\nimport { Sa5Core } from '../webflow-core'\r\n\r\n\r\n\r\nexport class WfuQuery {\r\n\r\n//    config; // Optional config\r\n\r\n    constructor() {\r\n\r\n//        this.config = config;\r\n\r\n    }\r\n\r\n    // Process elements with the custom attr wfu-query-param\r\n    init() {\r\n\r\n        const urlParams: URLSearchParams = new URLSearchParams(window.location.search);\r\n\r\n        // Skip if there is no querystring\r\n        if (Array.from(urlParams).length == 0)\r\n            return;\r\n\r\n        const that = this;\r\n\r\n        // Loop all processable elements\r\n        // - All <a> elements\r\n        // - Any element tagged with [wfu-query-param]=?\r\n        // TODO: ignore elems tagged [wfu-query-param]=- or eleme within a DIV tagged as such? \r\n\r\n        // Get all elements with 'wfu-query-param' attribute and all 'a' elements\r\n        let elements = Array.from(\r\n            document.querySelectorAll('*[wfu-query-param], a'));\r\n        \r\n        elements.forEach((element) => {\r\n            let wfuQueryParam = element.getAttribute('wfu-query-param');\r\n        \r\n            if (element.tagName.toLowerCase() === 'input' && wfuQueryParam) {\r\n                // For INPUT elements, set the value param\r\n                (element as HTMLInputElement).value = urlParams.get(wfuQueryParam) || '';\r\n            } else if (element.tagName.toLowerCase() === 'a') {\r\n                // FORMS\r\n                // IFRAMES \r\n\r\n                // DISABLED: temporarily \r\n//                this.processLink(element as HTMLLinkElement);\r\n            } else if (wfuQueryParam) {\r\n                // For anything else, set the inner text\r\n                element.textContent = urlParams.get(wfuQueryParam) || '';\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    processLink(linkElem: HTMLLinkElement) {\r\n\r\n        const urlParams = new URLSearchParams(window.location.search);\r\n\r\n        // Skip if no href\r\n        if (linkElem.getAttribute(\"href\") == null)\r\n            return;\r\n\r\n        // Disassemble url \r\n        var hrefParts = linkElem.getAttribute(\"href\").split(\"?\");\r\n        var hrefBase = hrefParts[0];\r\n        var hrefQuery = hrefParts[1];\r\n\r\n        const newParams = new URLSearchParams(hrefQuery);\r\n\r\n        // Handle suppressed elements\r\n        if (linkElem.getAttribute(\"wfu-query-param\") == '-') {\r\n\r\n            // Skip, do nothing\r\n            //        console.log(`Processing - / ${linkElem.attr(\"href\")}`);\r\n\r\n            // Handle all-params elements \r\n            // https://stackoverflow.com/questions/1318076/jquery-hasattr-checking-to-see-if-there-is-an-attribute-on-an-element\r\n        } else if (linkElem.getAttribute(\"wfu-query-param\") == '*' || linkElem.getAttribute(\"wfu-query-param\") == undefined || linkElem.hasAttribute(\"wfu-query-param\") == false) {\r\n\r\n            //        console.log(`Processing * / ${linkElem.attr(\"href\")} / ${hrefBase} / ${hrefQuery}`);\r\n\r\n            //        linkElem.text(`${linkElem.text()} - WILDCARD`);\r\n\r\n            // Merge querystrings\r\n            // overrwrites any conflicting params with new ones\r\n            for (let p of urlParams) {\r\n                newParams.set(p[0], urlParams.get(p[0]));\r\n            };\r\n\r\n            // Replaces whole querystring, preserving nothing\r\n            var newHref = hrefBase + '?' + newParams.toString();\r\n\r\n            // Update link href\r\n            linkElem.setAttribute(\"href\", newHref);\r\n\r\n            // Handle specific-params \r\n        } else {\r\n\r\n            //        console.log(`Process MULTI / ${linkElem.attr(\"href\")} / ${hrefBase} / ${hrefQuery}`);\r\n\r\n            // Duplicate params risk \r\n            // https://stackoverflow.com/a/60828146 \r\n\r\n            // Iterate through params and append\r\n            // e.g. [wfu-query-param]=\"foo,bar,bat\"\r\n            var overrideParams = linkElem.getAttribute(\"wfu-query-param\").split(\",\");\r\n\r\n            for (let p of overrideParams) {\r\n                if (urlParams.get(p) != null)\r\n                    newParams.set(p, urlParams.get(p));\r\n            };\r\n\r\n            var newHref = hrefBase + '?' + newParams.toString();\r\n\r\n            // Update link href\r\n            linkElem.setAttribute(\"href\", newHref);\r\n        }\r\n\r\n    }\r\n\r\n}\r\n"],
  "mappings": ";;AAeO,MAAM,WAAN,MAAe;AAAA,IAIlB,cAAc;AAAA,IAId;AAAA,IAGA,OAAO;AAEH,YAAM,YAA6B,IAAI,gBAAgB,OAAO,SAAS,MAAM;AAG7E,UAAI,MAAM,KAAK,SAAS,EAAE,UAAU;AAChC;AAEJ,YAAM,OAAO;AAQb,UAAI,WAAW,MAAM;AAAA,QACjB,SAAS,iBAAiB,uBAAuB;AAAA,MAAC;AAEtD,eAAS,QAAQ,CAAC,YAAY;AAC1B,YAAI,gBAAgB,QAAQ,aAAa,iBAAiB;AAE1D,YAAI,QAAQ,QAAQ,YAAY,MAAM,WAAW,eAAe;AAE5D,UAAC,QAA6B,QAAQ,UAAU,IAAI,aAAa,KAAK;AAAA,QAC1E,WAAW,QAAQ,QAAQ,YAAY,MAAM,KAAK;AAAA,QAMlD,WAAW,eAAe;AAEtB,kBAAQ,cAAc,UAAU,IAAI,aAAa,KAAK;AAAA,QAC1D;AAAA,MACJ,CAAC;AAAA,IAEL;AAAA,IAEA,YAAY,UAA2B;AAEnC,YAAM,YAAY,IAAI,gBAAgB,OAAO,SAAS,MAAM;AAG5D,UAAI,SAAS,aAAa,MAAM,KAAK;AACjC;AAGJ,UAAI,YAAY,SAAS,aAAa,MAAM,EAAE,MAAM,GAAG;AACvD,UAAI,WAAW,UAAU;AACzB,UAAI,YAAY,UAAU;AAE1B,YAAM,YAAY,IAAI,gBAAgB,SAAS;AAG/C,UAAI,SAAS,aAAa,iBAAiB,KAAK,KAAK;AAAA,MAOrD,WAAW,SAAS,aAAa,iBAAiB,KAAK,OAAO,SAAS,aAAa,iBAAiB,KAAK,UAAa,SAAS,aAAa,iBAAiB,KAAK,OAAO;AAQtK,iBAAS,KAAK,WAAW;AACrB,oBAAU,IAAI,EAAE,IAAI,UAAU,IAAI,EAAE,EAAE,CAAC;AAAA,QAC3C;AAAC;AAGD,YAAI,UAAU,WAAW,MAAM,UAAU,SAAS;AAGlD,iBAAS,aAAa,QAAQ,OAAO;AAAA,MAGzC,OAAO;AASH,YAAI,iBAAiB,SAAS,aAAa,iBAAiB,EAAE,MAAM,GAAG;AAEvE,iBAAS,KAAK,gBAAgB;AAC1B,cAAI,UAAU,IAAI,CAAC,KAAK;AACpB,sBAAU,IAAI,GAAG,UAAU,IAAI,CAAC,CAAC;AAAA,QACzC;AAAC;AAED,YAAI,UAAU,WAAW,MAAM,UAAU,SAAS;AAGlD,iBAAS,aAAa,QAAQ,OAAO;AAAA,MACzC;AAAA,IAEJ;AAAA,EAEJ;",
  "names": []
}
